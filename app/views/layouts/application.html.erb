<!DOCTYPE html>
<html lang="en" class="bg-slate-950 dark" data-controller="theme-toggle">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Primary Meta Tags -->
  <title><%= @title || 'Lukasz Czapiewski - Full Stack Developer' %></title>
  <meta name="title" content="<%= @title || 'Lukasz Czapiewski - Full Stack Developer' %>">
  <meta name="description" content="<%= @description || 'Full stack developer passionate about Ruby on Rails and building things that matter. Based in Cheltenham, UK.' %>">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="<%= @url || 'https://lukaszczapiewski.com' %>">
  <meta property="og:title" content="<%= @title || 'Lukasz Czapiewski - Full Stack Developer' %>">
  <meta property="og:description" content="<%= @description || 'Full stack developer passionate about Ruby on Rails and building things that matter. Based in Cheltenham, UK.' %>">
  <meta property="og:image" content="<%= @image || 'https://lukaszczapiewski.com/images/profile.jpeg' %>">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="<%= @url || 'https://lukaszczapiewski.com' %>">
  <meta property="twitter:title" content="<%= @title || 'Lukasz Czapiewski - Full Stack Developer' %>">
  <meta property="twitter:description" content="<%= @description || 'Full stack developer passionate about Ruby on Rails and building things that matter. Based in Cheltenham, UK.' %>">
  <meta property="twitter:image" content="<%= @image || 'https://lukaszczapiewski.com/images/profile.jpeg' %>">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="<%= @url || 'https://lukaszczapiewski.com' %>">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  
  <!-- Stylesheet -->
  <link rel="stylesheet" href="/assets/stylesheets/application.css">
  
  <!-- Theme Initialisation Script -->
  <script>
    (function() {
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
      }
      
      const savedTheme = getCookie('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const theme = savedTheme || (prefersDark ? 'dark' : 'light');
      
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    })();
  </script>
</head>
<body class="bg-slate-950 dark:bg-slate-950 bg-slate-50">
  <% 
    # Automatically set @current_page from @url if not already set
    @current_page ||= if @url
      uri = URI.parse(@url)
      uri.path
    else
      '/'
    end
  %>
  <main class="bg-slate-950 dark:bg-slate-950 bg-slate-50">
    <%= render 'shared/header' %>
    <%= page_content %>
    <%= render 'shared/footer' %>
  </main>

  <% if importmap_json %>
    <script type="importmap">
      <%= raw importmap_json %>
    </script>
  <% end %>

  <% if @js_modules && !@js_modules.empty? %>
    <% @js_modules.each do |module_name| %>
      <script type="module">import "<%= module_name %>";</script>
    <% end %>
  <% end %>
  <script type="module">import "application";</script>
</body>
</html>
